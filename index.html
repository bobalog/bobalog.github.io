<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>bobalog ì´ˆê°•ë ¥ ë²„ì „ ğŸ§‹</title>
  <style>
    @font-face { font-family: 'Mabiyet'; src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2207-01@1.0/MabinogiClassicR.woff2') format('woff2'); }
    body { background: #fdf0f5; font-family: 'Mabiyet', sans-serif; padding: 20px; display: flex; justify-content: center; }
    .container { width: 100%; max-width: 480px; }
    .card { background: white; padding: 20px; border-radius: 25px; box-shadow: 0 8px 15px rgba(0,0,0,0.05); margin-bottom: 20px; }
    .btn { padding: 12px; border-radius: 15px; border: none; background: #ffafcc; color: white; font-weight: bold; cursor: pointer; width: 100%; margin-top: 10px; }
    input { width: 100%; padding: 12px; border: 1px solid #ffc8dd; border-radius: 12px; box-sizing: border-box; margin-bottom: 10px; }
  </style>
</head>
<body>
  <div class="container">
    <div class="card" style="text-align:center;">
      <h1 style="color:#ff8fab;">ğŸ§‹ bobalog ë³¸ë¶€</h1>
      <p id="status-text" style="font-size:12px;color:red;">âš ï¸ ë¡œê·¸ì¸ ì „</p>
    </div>

    <div class="card" id="auth-box">
      <input type="email" id="u-email" placeholder="email" />
      <input type="password" id="u-pw" placeholder="password" />
      <button class="btn" id="loginBtn" type="button">ì¸ì¦í•˜ê³  DB ì—°ê²°í•˜ê¸° âœ…</button>
    </div>

    <div class="card">
      <input type="text" id="t-input" placeholder="í•  ì¼ ì…ë ¥..." />
      <button class="btn" style="background:#cdb4db;" id="addBtn" type="button">í•  ì¼ ì¶”ê°€</button>
      <ul id="t-list"></ul>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const SUPABASE_URL = "https://hyydywzsvnfhdrexntnl.supabase.co";
    const SUPABASE_ANON_KEY = "ë„ˆì˜_anon_key_ì—¬ê¸°"; // ì´ë¯¸ ì“°ë˜ í‚¤ë¡œ ë„£ì–´

    let sb = null;

    document.addEventListener("DOMContentLoaded", () => {
      console.log("DOM ë¡œë“œ ì™„ë£Œ");

      // 1) Supabase ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ ì²´í¬
      if (!window.supabase) {
        alert("Supabase ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ ì‹¤íŒ¨! (CDN ì°¨ë‹¨/ì˜¤í”„ë¼ì¸/ì£¼ì†Œ í™•ì¸)");
        return;
      }

      // 2) í´ë¼ì´ì–¸íŠ¸ ìƒì„±
      sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
      console.log("Supabase client ready:", !!sb);

      // 3) ë²„íŠ¼ ì´ë²¤íŠ¸ ì—°ê²° (ì—¬ê¸°ê°€ í•µì‹¬)
      document.getElementById("loginBtn").addEventListener("click", login);
      document.getElementById("addBtn").addEventListener("click", localAdd);
    });

    async function login() {
      alert("ë²„íŠ¼ í´ë¦­ ë¨ âœ… (ì—¬ê¸° ëœ¨ë©´ í´ë¦­ ë¬¸ì œëŠ” ë!)");

      const email = document.getElementById("u-email").value.trim();
      const password = document.getElementById("u-pw").value;

      if (!sb) {
        alert("Supabase ì´ˆê¸°í™”ê°€ ì•ˆ ëì–´! ì½˜ì†”(F12) í™•ì¸í•´ì¤˜.");
        return;
      }

      const { data, error } = await sb.auth.signInWithPassword({ email, password });

      if (error) {
        alert("ë¡œê·¸ì¸ ì‹¤íŒ¨: " + error.message);
        console.log(error);
        return;
      }

      document.getElementById("status-text").innerText = "âœ… DB ì—°ê²° ì™„ë£Œ";
      document.getElementById("status-text").style.color = "green";
      alert("ì„±ê³µ! ğŸ‰");
      console.log("login data:", data);
    }

    function localAdd() {
      const val = document.getElementById("t-input").value.trim();
      if (!val) return;
      const li = document.createElement("li");
      li.innerText = val;
      document.getElementById("t-list").appendChild(li);
      document.getElementById("t-input").value = "";
    }
  </script>
</body>
</html>
