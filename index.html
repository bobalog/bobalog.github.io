<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>bobalog ë³¸ë¶€ ğŸ§‹</title>
  <style>
    @font-face { font-family: 'Mabiyet'; src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2207-01@1.0/MabinogiClassicR.woff2') format('woff2'); }
    :root { --main-pink: #ffafcc; --bg-color: #fdf0f5; }
    body { background-color: var(--bg-color); font-family: 'Mabiyet', sans-serif; display: flex; flex-direction: column; align-items: center; padding: 20px; color: #555; margin: 0; }
    .container { width: 100%; max-width: 500px; }
    .card { background: white; padding: 20px; border-radius: 25px; box-shadow: 0 8px 16px rgba(0,0,0,0.05); margin-bottom: 20px; text-align: center; }
    .btn { width: 100%; padding: 12px; border-radius: 15px; border: none; background: #cdb4db; color: white; font-weight: bold; cursor: pointer; font-family: 'Mabiyet'; font-size: 16px; transition: 0.3s; }
    .btn:hover { background: #b592c4; }
    .chip { font-size: 12px; padding: 4px 10px; border-radius: 999px; background: #ffe5ee; color: #a35a72; display: inline-block; margin-top: 10px; }
    .hidden { display: none; }
  </style>
</head>
<body>

  <div class="container">
    <div class="card">
      <h1 style="color: #ff8fab; margin: 0;">ğŸ§‹ bobalog ë³¸ë¶€</h1>
      <div id="login-chip" class="chip">ğŸš€ ì‹œìŠ¤í…œ ë¡œë”© ì¤‘...</div>
    </div>

    <div id="auth-section" class="card">
      <h2 style="color: #ff8fab;">ğŸ” íƒœìœ¤ ì „ìš© ë¡œê·¸ì¸</h2>
      <button class="btn" onclick="handleLogin()">ì ‘ì†í•˜ê¸° âœ…</button>
    </div>

    <div id="main-section" class="card hidden">
      <h2 style="color: #ff8fab;">ì„±ê³µ! ğŸ‰</h2>
      <p>íƒœìœ¤ì•„ ì´ì œ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆì–´!</p>
      <button class="btn" style="background:#ffafcc" onclick="location.reload()">ìƒˆë¡œê³ ì¹¨</button>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.7/dist/umd/supabase.js"></script>

  <script>
    const SUPABASE_URL = "https://hyydywzsvnfhdrexntnl.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh5eWR5d3pzdm5maGRyZXhudG5sIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYxMjE3MTAsImV4cCI6MjA4MTY5NzcxMH0.2vrbtBozzHeUle9a1foYmsz4o3jkPN5GtbBM0F-eK20";
    
    let supabase;
    const chip = document.getElementById('login-chip');

    // 1. í˜ì´ì§€ ë¡œë“œ ì‹œ ë°”ë¡œ ì‹¤í–‰
    async function init() {
      try {
        // ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ ì²´í¬
        if (typeof window.supabase === 'undefined') {
          chip.innerText = "âš ï¸ ì„œë²„ ì—°ê²° ë„êµ¬ ë¡œë“œ ì‹¤íŒ¨ (ìƒˆë¡œê³ ì¹¨ í•´ì¤˜!)";
          return;
        }

        supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        
        // ë¡œê·¸ì¸ ì„¸ì…˜ í™•ì¸
        const { data: { session }, error } = await supabase.auth.getSession();
        if (error) throw error;

        if (session) {
          document.getElementById('auth-section').classList.add('hidden');
          document.getElementById('main-section').classList.remove('hidden');
          chip.innerText = "íƒœìœ¤ë‹˜ ì¸ì¦ ì™„ë£Œ ğŸŸ¢";
        } else {
          chip.innerText = "ë¡œê·¸ì¸ ëŒ€ê¸° ì¤‘... ğŸ”´";
        }
      } catch (e) {
        chip.innerText = "âŒ ì—ëŸ¬ ë°œìƒ: " + e.message;
        console.error(e);
      }
    }

    // 2. ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­
    async function handleLogin() {
      chip.innerText = "ğŸ”‘ ì¸ì¦ ì‹œë„ ì¤‘...";
      try {
        const { error } = await supabase.auth.signInWithPassword({
          email: "abc.bobatea@gmail.com",
          password: "rltgjqm"
        });

        if (error) {
          alert("ì‹¤íŒ¨: " + error.message);
          chip.innerText = "ë¡œê·¸ì¸ ì‹¤íŒ¨ âŒ";
        } else {
          location.reload(); // ì„±ê³µí•˜ë©´ ìƒˆë¡œê³ ì¹¨í•´ì„œ ì„¸ì…˜ ì ìš©
        }
      } catch (e) {
        alert("ì—ëŸ¬: " + e.message);
      }
    }

    // ì‹¤í–‰ ì‹œì‘!
    init();
  </script>
</body>
</html>
